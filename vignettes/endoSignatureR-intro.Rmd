---
title: "endoSignatureR-intro"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{endoSignatureR-intro}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  comment = "#>"
)
```

```{r setup}
library(endoSignatureR)
```

# Introduction

`endoSignatureR` is a package for discovering small, interpretable gene signatures from bulk RNA-seq data with binary phenotypes in small cohorts. The package provides three distinct workflows:

- **Mode 1 (Rapid Classification)**: Apply pre-trained signature to new samples
- **Mode 2 (Signature Validation)**: Train and validate signatures on labeled data
- **Mode 3 (Visualization & Analysis)**: Explore and visualize data with QC plots

For detailed workflow demonstrations, see the dedicated vignettes:

- `browseVignettes("endoSignatureR")` - List all available vignettes
- Mode 3: `vignette("mode3-visualization-analysis", package = "endoSignatureR")`
- Mode 2: `vignette("mode2-signature-validation", package = "endoSignatureR")`
- Mode 1: `vignette("mode1-rapid-classification", package = "endoSignatureR")` (coming in Phase 3.2)

## Pre-trained Signature Artifacts

The package ships with a pre-trained PS vs PIS signature trained on the full GSE201926 dataset. The pre-trained signature artifacts are stored in `inst/extdata/pretrained-signature/` and can be accessed via `system.file("extdata", "pretrained-signature", ...)`:

- **`endometrial_signature.csv`**: Gene panel with coefficients, selection frequencies, and optional bootstrap frequencies
- **`endometrial_recipe.json`**: Preprocessing recipe, training parameters, signature metadata, and reproducibility information
- **`endometrial_model_card.md`**: Model documentation with provenance, performance metrics, limitations, and intended use
- **`endometrial_stability.csv`** (optional): Bootstrap stability frequencies for signature genes

### Artifact Provenance

The pre-trained signature was trained on the full GSE201926 endometrial lesion RNA-seq dataset using the Phase 2 pipeline (`esr_trainEndometrialSignature()`). Training parameters:

- **Dataset**: Full GSE201926 (all 12 samples, all genes after filtering)
- **Transform**: log1p-CPM transformation
- **CV Structure**: Leave-Pair-Out (LPO) for small n (n=12) with balanced classes
- **Lambda Selection**: 1se rule (1 standard error rule for sparsity)
- **Aggregation**: Mean aggregation across outer folds
- **Calibration**: Platt scaling for probability calibration
- **Stability Selection**: Bootstrap resampling (500 resamples)

The pre-trained signature artifacts are reproducible and documented in the model card, which includes training data provenance, performance metrics, limitations, and intended use. See `inst/extdata/pretrained-signature/endometrial_model_card.md` for full documentation.

### Loading Pre-trained Signature

The pre-trained signature can be loaded using `esr_loadPretrainedSignature()` (to be implemented in Phase 3.2). This function will read artifacts from `inst/extdata/pretrained-signature/` and return a signature object ready for classification.

```{r load-pretrained-placeholder, eval=FALSE}
# Placeholder for Phase 3.2 implementation
# signature <- esr_loadPretrainedSignature()
# signature$panel  # Gene panel
# signature$coefficients  # Coefficients
# signature$intercept  # Intercept
```

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/train.R
\name{esr_selectDEInFold}
\alias{esr_selectDEInFold}
\title{Select Top Genes by DE In-Fold (Anti-leakage)}
\usage{
esr_selectDEInFold(
  split,
  mat_t,
  pheno,
  group_col = "group",
  n = 50,
  method = c("de", "variance"),
  seed = 123
)
}
\arguments{
\item{split}{An \code{rsample} split object (e.g., from \code{rsample::vfold_cv()}).}

\item{mat_t}{A samples x genes transformed matrix for full dataset.}

\item{pheno}{Data.frame with sample metadata; must include \code{sample_id} and group column.}

\item{group_col}{Character scalar; name of phenotype column with PS/PIS labels. Defaults to "group".}

\item{n}{Integer; number of genes to select. Defaults to 50.}

\item{method}{Character scalar; selection method: "de" (differential expression) or "variance". Defaults to "de".}

\item{seed}{Integer; random seed for reproducibility. Defaults to 123.}
}
\value{
A character vector of selected gene IDs (length \code{n} or fewer).
}
\description{
Selects top-K genes via differential expression analysis within CV fold,
using training data only to prevent data leakage.
}
\details{
This function enforces anti-leakage by:
\itemize{
\item Performing DE analysis on training data only
\item Selecting genes based on training-only statistics
\item Never using test/validation data for gene selection
}
}
\examples{
\dontrun{
library(rsample)
data(gse201926_trainmini)
mat_t <- esr_transform_log1p_cpm(gse201926_trainmini$counts)
set.seed(123)
splits <- vfold_cv(gse201926_trainmini$pheno, v = 3)
selected <- esr_selectDEInFold(splits$splits[[1]],
  mat_t,
  gse201926_trainmini$pheno,
  n = 50
)
length(selected)
}
}
\references{
Ritchie, M. E., Phipson, B., Wu, D., Hu, Y., Law, C. W., Shi, W., & Smyth, G. K.
(2015). limma powers differential expression analyses for RNA-sequencing and
microarray studies. Nucleic Acids Research, 43(7), e47.

Frick, H., Chow, F., Kuhn, M., Mahoney, M., Silge, J., & Wickham, H.
(2025). rsample: General resampling infrastructure. R package.
\url{https://CRAN.R-project.org/package=rsample}.
}

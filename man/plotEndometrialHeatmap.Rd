% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{plotEndometrialHeatmap}
\alias{plotEndometrialHeatmap}
\title{Plot Endometrial Heatmap}
\usage{
plotEndometrialHeatmap(
  mat_t,
  genes = NULL,
  pheno = NULL,
  group_col = "group",
  annot_cols = NULL,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  show_row_names = FALSE,
  show_col_names = TRUE,
  scale = c("row", "column", "none"),
  color_palette = NULL,
  ...
)
}
\arguments{
\item{mat_t}{A samples Ã— genes transformed matrix (e.g., from \code{esr_transform_log1p_cpm()}).}

\item{genes}{Optional character vector of gene IDs to plot. If NULL, plots all genes. For large matrices, recommend selecting subset (e.g., using \code{esr_selectTopGenes()}).}

\item{pheno}{Optional data.frame with sample metadata for column annotations.}

\item{group_col}{Character scalar; name of the phenotype column for group coloring. Defaults to "group".}

\item{annot_cols}{Optional character vector of additional annotation column names from pheno to display.}

\item{cluster_rows}{Logical; whether to cluster genes (rows). Defaults to TRUE.}

\item{cluster_cols}{Logical; whether to cluster samples (columns). Defaults to TRUE.}

\item{show_row_names}{Logical; whether to show gene names (rows). Defaults to FALSE (typically set to FALSE for large heatmaps).}

\item{show_col_names}{Logical; whether to show sample names (columns). Defaults to TRUE.}

\item{scale}{Character scalar; scaling method: "row" (z-score per gene), "column" (z-score per sample), or "none" (no scaling). Defaults to "row".}

\item{color_palette}{Optional color palette function (default: color-blind friendly).}

\item{...}{Additional arguments passed to \code{ComplexHeatmap::Heatmap()}.}
}
\value{
A ComplexHeatmap Heatmap object (use \code{ComplexHeatmap::draw()} to display).
}
\description{
Creates a heatmap visualization of gene expression patterns across samples using ComplexHeatmap.
}
\details{
This function creates publication-quality heatmaps using ComplexHeatmap. For large datasets (e.g., full 39,368 genes),
it is recommended to select a subset of genes (e.g., top-50 by variance or top-K by DE) to ensure readable output.

Column annotations (e.g., group labels) can be added via the \code{pheno} parameter.
}
\examples{
data(gse201926_sample)
mat_t <- esr_transform_log1p_cpm(gse201926_sample$counts)

# Create heatmap with top 20 genes by variance
top_genes <- esr_selectTopGenes(mat_t, n = 20, by = "variance")
p <- plotEndometrialHeatmap(mat_t, genes = top_genes, pheno = gse201926_sample$pheno)
ComplexHeatmap::draw(p)

# Create heatmap with phenotype annotations
p <- plotEndometrialHeatmap(mat_t,
    genes = top_genes, pheno = gse201926_sample$pheno,
    show_row_names = TRUE, scale = "row"
)
ComplexHeatmap::draw(p)
}

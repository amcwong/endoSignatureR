% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{esr_selectTopGenes}
\alias{esr_selectTopGenes}
\title{Select Top Genes by Variance, DE, or Custom Criteria}
\usage{
esr_selectTopGenes(
  mat_t = NULL,
  de_table = NULL,
  n = 50,
  by = c("variance", "de", "custom"),
  sort_col = NULL
)
}
\arguments{
\item{mat_t}{A samples Ã— genes transformed matrix (e.g., from \code{esr_transform_log1p_cpm()}). Required for variance-based selection.}

\item{de_table}{Optional data.frame from \code{esr_analyzeDifferentialExpression()} with columns: \code{gene_id}, \code{log2FC}, \code{FDR}. Required for DE-based selection.}

\item{n}{Integer; number of genes to select. Defaults to 50.}

\item{by}{Character scalar; selection method: "variance" (default), "de", or "custom".}

\item{sort_col}{Character scalar; column name in \code{de_table} for custom sorting (only used when \code{by = "custom"}). Defaults to NULL.}
}
\value{
Character vector of gene IDs (length \code{n}, or fewer if fewer genes available).
}
\description{
Selects top-K genes based on specified criteria (variance, differential expression, or custom sorting).
}
\details{
Selection methods:
\itemize{
\item \code{by = "variance"}: Selects genes with highest variance across samples (useful for exploratory heatmaps). Requires \code{mat_t}.
\item \code{by = "de"}: Selects top-K genes from DE table (sorted by FDR ascending, then by absolute log2FC descending). Requires \code{de_table}.
\item \code{by = "custom"}: Uses \code{sort_col} to sort genes (ascending order). Requires \code{de_table} and \code{sort_col}.
}

For variance-based selection, ties in variance are broken deterministically by gene ID (alphabetical order).
For DE-based selection, genes are first sorted by FDR (ascending), then by absolute log2FC (descending).
}
\examples{
data(gse201926_sample)
mat_t <- esr_transform_log1p_cpm(gse201926_sample$counts)

# Select top 20 genes by variance
top_var <- esr_selectTopGenes(mat_t, n = 20, by = "variance")
head(top_var)

# Select top 10 genes by DE
de_table <- esr_analyzeDifferentialExpression(mat_t, gse201926_sample$pheno)
top_de <- esr_selectTopGenes(de_table = de_table, n = 10, by = "de")
head(top_de)
}
\references{
Ritchie, M. E., Phipson, B., Wu, D., Hu, Y., Law, C. W., Shi, W., & Smyth, G. K.
(2015). limma powers differential expression analyses for RNA-sequencing and
microarray studies. Nucleic Acids Research, 43(7), e47.
}

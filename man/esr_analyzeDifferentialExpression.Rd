% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/validate.R
\name{esr_analyzeDifferentialExpression}
\alias{esr_analyzeDifferentialExpression}
\title{Analyze Differential Expression}
\usage{
esr_analyzeDifferentialExpression(
  mat_t,
  pheno,
  group_col = "group",
  transform = "log1p-cpm",
  contrast = NULL,
  fdr_method = "BH",
  seed = 123
)
}
\arguments{
\item{mat_t}{A samples x genes transformed matrix (e.g., from \code{esr_transform_log1p_cpm()}).}

\item{pheno}{A data.frame with sample metadata; must include \code{sample_id} and group column.}

\item{group_col}{Character scalar; name of the phenotype column containing PS/PIS labels. Defaults to "group".}

\item{transform}{Character scalar; type of transform used (informational only, not used in analysis). Defaults to "log1p-cpm".}

\item{contrast}{Character vector or NULL; contrasts to extract. If NULL, defaults to comparing last level vs first level of group. Defaults to NULL.}

\item{fdr_method}{Character scalar; method for FDR adjustment. Defaults to "BH" (Benjamini-Hochberg).}

\item{seed}{Integer; random seed for reproducibility. Defaults to 123.}
}
\value{
A data.frame with columns:
\describe{
\item{gene_id}{Character; gene identifiers (rownames from mat_t)}
\item{log2FC}{Numeric; log2 fold change}
\item{pvalue}{Numeric; unadjusted p-value}
\item{FDR}{Numeric; FDR-adjusted p-value}
\item{AveExpr}{Numeric; mean expression across samples}
\item{t}{Numeric; moderated t-statistic}
}
Results are sorted by FDR (ascending), then by absolute log2FC (descending).
}
\description{
Performs differential expression analysis using limma on transformed data
with a design matrix for PS vs PIS comparison.
}
\examples{
data(gse201926_sample)
mat_t <- esr_transform_log1p_cpm(gse201926_sample$counts)
de_table <- esr_analyzeDifferentialExpression(mat_t, gse201926_sample$pheno)
head(de_table)
}
\references{
Ritchie, M. E., Phipson, B., Wu, D., Hu, Y., Law, C. W., Shi, W., & Smyth, G. K.
(2015). limma powers differential expression analyses for RNA-sequencing and
microarray studies. Nucleic Acids Research, 43(7), e47.
}

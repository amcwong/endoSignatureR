% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pretrained.R
\name{esr_classifyEndometrial}
\alias{esr_classifyEndometrial}
\title{Classify Endometrial Samples Using a Signature}
\usage{
esr_classifyEndometrial(
  X_new,
  signature = NULL,
  threshold = 0.5,
  confidence = TRUE,
  y_new = NULL
)
}
\arguments{
\item{X_new}{A matrix/data.frame of gene expression (genes x samples) for new samples.
Must have rownames (gene IDs) and colnames (sample IDs).}

\item{signature}{Optional signature list; if NULL, loads the shipped pre-trained signature.}

\item{threshold}{Decision threshold for positive class. Defaults to 0.5. Can be numeric (0-1) or "youden" (requires labeled validation data via y_new).}

\item{confidence}{Logical; whether to compute confidence outputs. Defaults to TRUE.}

\item{y_new}{Optional vector of validation labels (PS/PIS or 0/1). Required if threshold = "youden".}
}
\value{
If alerts are generated, returns a list with:
\describe{
\item{predictions}{Data.frame with per-sample predictions containing columns:
\describe{
\item{sample}{Character; sample IDs (colnames of X_new)}
\item{score}{Numeric; raw signature score (linear combination)}
\item{probability}{Numeric; calibrated probability (if calibration available) or sigmoid-transformed score}
\item{prediction}{Factor; binary predictions (PS or PIS) based on threshold}
\item{confidence_lower}{Numeric; lower confidence bound (if confidence = TRUE)}
\item{confidence_upper}{Numeric; upper confidence bound (if confidence = TRUE)}
}
}
\item{alerts}{Data.frame with validation alerts containing columns:
\describe{
\item{type}{Character; alert type (warning, info, error)}
\item{message}{Character; alert message}
\item{severity}{Character; severity level (low, medium, high)}
}
}
}
If no alerts are generated, returns the predictions data.frame directly (for backward compatibility).
}
\description{
Applies a pre-trained signature to new endometrial samples and returns predictions with confidence scores.
}
\details{
This function applies a pre-trained signature to new endometrial samples:
\itemize{
\item Validates data structure and performs domain/tissue checks (ID mapping, missing genes)
\item Applies preprocessing recipe (transform, filter) to match training pipeline
\item Computes signature scores using linear combination
\item Applies calibration if available (Platt scaling or isotonic regression)
\item Applies threshold to get binary predictions (PS vs PIS)
\item Computes confidence intervals if requested
}

Domain checks include:
\itemize{
\item Gene ID namespace matching (warns if mapping rate < 80\%)
\item Missing signature gene handling (sets to 0 with warning)
\item Class imbalance detection (if pheno provided)
}
}
\examples{
# Load signature
signature <- esr_loadPretrainedSignature()

# Load sample data (treat as unlabeled)
data(gse201926_sample)
X_new <- gse201926_sample$counts

# Classify samples
predictions <- esr_classifyEndometrial(
  X_new = X_new,
  signature = signature,
  threshold = 0.5,
  confidence = TRUE
)

# View predictions
head(predictions)
table(predictions$prediction)

}
\references{
Friedman, J., Hastie, T., & Tibshirani, R. (2010). Regularization paths for
generalized linear models via coordinate descent. Journal of Statistical
Software, 33(1), 1-22. \url{https://doi.org/10.18637/jss.v033.i01}.
}
